import{d as E,t as k,o as L,c as g,e as i,f as l,i as t,I as M,n as O,j as n,F as v,D as C,k as S,y as $,x as w,v as y,E as B}from"./index-689ac86d.js";import{S as G,F as b,T as R,a as N}from"./index-5537dfd3.js";import{o as q,a as D}from"./utils-9744f3f3.js";const z={class:"table-container config"},Q=E({__name:"commands",setup(A){const F=["user","manager","master"],T=["仅群聊","仅私聊","无限制"],j=[{label:"单指令头",value:"single"},{label:"拆分指令头",value:"divided"}],h=k({}),o=k(!1);async function I(){o.value=!0;try{const d=await O.CONFIG_GET.get({fileName:"commands"});for(const r in d.data){const p=d.data[r];Object.prototype.toString.call(p)!=="[object Object]"&&delete d.data[r]}h.value=d.data}catch{}o.value=!1}L(()=>{I()});async function u(d,r){o.value=!0;const p=`${d}.${r}`,V=d.split(".").length-1,f=q(h.value,p,V),c={};D(c,p,f,V);try{await O.CONFIG_SET.post({fileName:"commands",data:c}),B({title:"成功",message:"更新成功。",type:"success",duration:1e3})}catch{}o.value=!1}const _=k(null);function U(d){_.value=d}return(d,r)=>{const p=g("el-alert"),V=g("el-switch"),f=g("el-radio"),c=g("el-radio-group"),x=g("el-form");return n(),i("div",z,[l(p,{title:"该页内容修改完毕后续重启BOT或刷新配置才能生效",type:"warning","show-icon":""}),l(x,{model:h.value,class:"config-form",onSubmit:r[0]||(r[0]=M(()=>{},["prevent"]))},{default:t(()=>[(n(!0),i(v,null,C(h.value,(a,s)=>(n(),i("div",{key:s,class:"config-section"},[l(G,{title:s},null,8,["title"]),l(b,{label:"启用"},{default:t(()=>[l(V,{modelValue:a.enable,"onUpdate:modelValue":e=>a.enable=e,disabled:o.value,onChange:e=>u(s,"enable")},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:2},1024),a.enable?(n(),i(v,{key:0},[l(b,{label:"最低操作权限"},{default:t(()=>[l(c,{modelValue:a.auth,"onUpdate:modelValue":e=>a.auth=e,disabled:o.value,onChange:e=>u(s,"auth")},{default:t(()=>[(n(),i(v,null,C(F,(e,m)=>l(f,{key:m,label:m+1},{default:t(()=>[S($(e),1)]),_:2},1032,["label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:2},1024),l(b,{label:"可用范围"},{default:t(()=>[l(c,{modelValue:a.scope,"onUpdate:modelValue":e=>a.scope=e,disabled:o.value,onChange:e=>u(s,"scope")},{default:t(()=>[(n(),i(v,null,C(T,(e,m)=>l(f,{key:m,label:m+1},{default:t(()=>[S($(e),1)]),_:2},1032,["label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:2},1024),a.type==="order"||a.type==="enquire"?(n(),w(b,{key:0,label:"指令头",desc:"以 __ 开头来屏蔽 setting 中配置的 header。"},{default:t(()=>[a.headers?(n(),w(R,{key:0,modelValue:a.headers,"onUpdate:modelValue":e=>a.headers=e,disabled:o.value,limit:1,onChange:e=>u(s,"headers")},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])):y("",!0)]),_:2},1024)):a.type==="switch"?(n(),i(v,{key:1},[l(b,{label:"指令头模式"},{default:t(()=>[l(c,{modelValue:a.mode,"onUpdate:modelValue":e=>a.mode=e,disabled:o.value,onChange:e=>u(s,"mode")},{default:t(()=>[(n(),i(v,null,C(j,(e,m)=>l(f,{key:m,label:e.value},{default:t(()=>[S($(e.label),1)]),_:2},1032,["label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:2},1024),l(N,{modelValue:a.onKey,"onUpdate:modelValue":e=>a.onKey=e,"active-spread":_.value,disabled:o.value,label:"关键词(开)",placeholder:"请输入关键词",verifyReg:".+",verifyMsg:"该项为必填项",onChange:e=>u(s,"onKey"),onOpen:U},null,8,["modelValue","onUpdate:modelValue","active-spread","disabled","onChange"]),l(N,{modelValue:a.offKey,"onUpdate:modelValue":e=>a.offKey=e,"active-spread":_.value,disabled:o.value,label:"关键词(关)",placeholder:"请输入关键词",verifyReg:".+",verifyMsg:"该项为必填项",onChange:e=>u(s,"offKey"),onOpen:U},null,8,["modelValue","onUpdate:modelValue","active-spread","disabled","onChange"]),a.mode!=="divided"?(n(),w(N,{key:0,"active-spread":_.value,modelValue:a.header,"onUpdate:modelValue":e=>a.header=e,disabled:o.value,label:"指令头",placeholder:"请输入指令头",verifyReg:".+",verifyMsg:"该项为必填项",desc:"以 __ 开头来屏蔽 setting 中配置的 header。",onChange:e=>u(s,"header"),onOpen:U},null,8,["active-spread","modelValue","onUpdate:modelValue","disabled","onChange"])):y("",!0)],64)):y("",!0)],64)):y("",!0)]))),128))]),_:1},8,["model"])])}}});export{Q as default};
